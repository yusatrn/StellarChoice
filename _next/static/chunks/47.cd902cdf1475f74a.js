"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[47],{4047:(e,t,o)=>{o.r(t),o.d(t,{default:()=>T});var n=o(5155),a=o(2115),r=o(6245),s=o(7535),l=o(6338);let c={networkUrl:"https://horizon-testnet.stellar.org",sorobanRpcUrl:"https://soroban-testnet.stellar.org",networkPassphrase:"Test SDF Network ; September 2015",contractId:"CAPINXA4OLRUTPEGCHSY7DZFS6VIPJNIQ53Y6DOBUVBPOUPSIA3JNFUD"},i=new s.SorobanRpc.Server(c.sorobanRpcUrl,{allowHttp:!0}),d=new s.Horizon.Server(c.networkUrl),{TransactionBuilder:u,Networks:m,scValToNative:g,nativeToScVal:h,Operation:w,Account:x,Contract:f,Memo:y,BASE_FEE:p,Keypair:b,SorobanDataBuilder:v,xdr:k,TimeoutInfinite:j,StrKey:N}=s;async function S(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30,o=0,n=null;for(console.log("Starting to wait for transaction ".concat(e," (max ").concat(t," attempts)"));o<t;){try{console.log("Checking transaction status (attempt ".concat(o+1,"/").concat(t,")..."));let u=await fetch("".concat(c.networkUrl,"/transactions/").concat(e));if(u.ok){let e=await u.json();if(console.log("Transaction status:",e.status,"Ledger:",e.ledger_attr),"SUCCESS"===e.status||"FAILED"===e.status){if(console.log("Transaction ".concat(e.status," in ledger ").concat(e.ledger_attr)),e.result_meta_xdr)try{var a,r,l,i,d;let t=s.xdr.TransactionMeta.fromXDR(e.result_meta_xdr,"base64");if(t.v3&&(null==(a=t.v3())?void 0:a.sorobanMeta)&&(null==(l=t.v3())||null==(r=l.sorobanMeta())?void 0:r.returnValue))return{...e,status:e.status.toUpperCase(),returnValue:null==(d=t.v3())||null==(i=d.sorobanMeta())?void 0:i.returnValue(),resultXdr:e.result_xdr,resultMetaXdr:e.result_meta_xdr}}catch(e){console.warn("Error parsing transaction meta:",e)}return{...e,status:e.status.toUpperCase(),resultXdr:e.result_xdr,resultMetaXdr:e.result_meta_xdr}}}else{let a=await u.text().catch(()=>"No error details");n=Error("HTTP ".concat(u.status,": ").concat(a)),404===u.status?console.warn("Transaction ".concat(e," not found (attempt ").concat(o+1,"/").concat(t,").")):console.warn("Horizon error fetching tx ".concat(e,": ").concat(u.status," - ").concat(a))}}catch(e){n=e,console.error("Error checking transaction status:",e)}let u=Math.min(1e3*Math.pow(1.5,o),1e4);console.log("Waiting ".concat(u,"ms before next check...")),await new Promise(e=>setTimeout(e,u)),o++}let u="Transaction ".concat(e," confirmation timeout after ").concat(o," attempts.");console.error(u,{lastError:n});let m=Error(u);throw m.lastError=n,m}function C(e,t,o){let n,a=new Promise((e,a)=>{n=setTimeout(()=>{a(Error("".concat(o," (timeout after ").concat(t,"ms)")))},t)});return Promise.race([e.finally(()=>clearTimeout(n)),a])}async function E(e,t,o,n){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:12e4;try{let u;if(console.log("Calling contract function: ".concat(e),{source:o,contractId:c.contractId,args:t.map(e=>s.scValToNative(e)),isReadOnly:n}),!s.StrKey.isValidEd25519PublicKey(o))throw Error("Invalid source address: ".concat(o));if(!c.contractId||c.contractId.length<10)throw Error("Invalid contract ID: ".concat(c.contractId));let m=new s.Contract(c.contractId).call(e,...t);if(n){var r;console.log("Simulating read-only operation...");let t=await d.loadAccount(o),n=new s.Account(o,t.sequenceNumber()),a=new s.TransactionBuilder(n,{fee:s.BASE_FEE,networkPassphrase:c.networkPassphrase}).addOperation(m).setTimeout(30).build(),l=await i.simulateTransaction(a);if("error"in l)throw Error("Simulation failed: ".concat(JSON.stringify(l.error)));if(null==(r=l.result)?void 0:r.retval)return l.result.retval;if("has_voted"===e)return s.xdr.ScVal.scvBool(!1);if("get_vote_count"===e)return s.xdr.ScVal.scvU32(0);return s.xdr.ScVal.scvVoid()}console.log("Preparing transaction...");let g=await d.loadAccount(o),h=new s.Account(o,g.sequenceNumber()),w=new s.TransactionBuilder(h,{fee:s.BASE_FEE,networkPassphrase:c.networkPassphrase});w.addOperation(m).setTimeout(30);let x=w.build();console.log("Simulating transaction...");let f=await i.simulateTransaction(x);if("error"in f)throw Error("Simulation failed: ".concat(JSON.stringify(f.error)));let y=await d.loadAccount(o),p=new s.Account(o,y.sequenceNumber()),b=s.BASE_FEE,v=f.minResourceFee?parseInt(f.minResourceFee):0,k=(parseInt(b)+v).toString();console.log("Transaction fees - Base: ".concat(b,", Resource: ").concat(v,", Total: ").concat(k));let j=new s.TransactionBuilder(p,{fee:k,networkPassphrase:c.networkPassphrase});if(j.addOperation(m).setTimeout(30),f.transactionData)try{let e;if(console.log("Raw transaction data from simulation:",f.transactionData),"string"==typeof f.transactionData)console.log("Using transaction data as XDR string"),e=f.transactionData;else if(f.transactionData instanceof s.SorobanDataBuilder){console.log("Building Soroban data from builder");let t=f.transactionData;f.minResourceFee&&t.setResourceFee(f.minResourceFee.toString()),e=t.build().toXDR("base64")}else if(f.transactionData&&"function"==typeof f.transactionData.toXDR)console.log("Converting transaction data to XDR"),e=f.transactionData.toXDR();else{console.log("Creating new SorobanDataBuilder with simulation data");let t=new s.SorobanDataBuilder;f.minResourceFee&&t.setResourceFee(f.minResourceFee.toString()),e=t.build().toXDR("base64")}console.log("Setting Soroban data with XDR:",e),j.setSorobanData(e)}catch(e){throw console.error("Failed to set Soroban data:",e),Error("Failed to set Soroban transaction data: ".concat(e instanceof Error?e.message:String(e)))}let N=j.build().toXDR();console.log("Transaction built, signing with Freighter..."),console.log("Sending transaction to Freighter for signing...");let E=await l.signTransaction(N,{networkPassphrase:c.networkPassphrase});if("string"==typeof E)u=E;else if(E&&"object"==typeof E&&"signedTxXdr"in E)u=E.signedTxXdr;else throw Error("Unexpected response from Freighter");console.log("Transaction signed, submitting to network..."),console.log("Submitting transaction to the network...");let T=(async()=>{let e=new URLSearchParams;e.append("tx",u);let t=await fetch("".concat(c.networkUrl,"/transactions"),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e.toString()}),o=await t.json();if(!t.ok){var n,r;console.error("Transaction submission failed. Status:",t.status,"Response:",o);let e=o.detail||t.statusText;(null==(n=o.extras)?void 0:n.result_codes)&&(e+="\nResult codes: ".concat(JSON.stringify(o.extras.result_codes,null,2))),(null==(r=o.extras)?void 0:r.result_xdr)&&(e+="\nResult XDR: ".concat(o.extras.result_xdr));let a=Error("Transaction submission failed: ".concat(e));throw a.extras=o.extras,a.status=t.status,a}let l=o.hash||o.id;console.log("Transaction submitted with hash: ".concat(l)),console.log("Waiting for transaction confirmation...");let i=await C(S(l),a-3e4,"Transaction confirmation timed out");if("SUCCESS"!==i.status)throw console.error("Transaction failed:",i),Error("Transaction failed with status: ".concat(i.status));return console.log("Transaction completed successfully"),i.returnValue||s.xdr.ScVal.scvVoid()})();return await C(T,a,"Transaction processing timed out")}catch(a){let n=a instanceof Error?a.message:String(a);if(a&&"object"==typeof a&&"errorResultXdr"in a&&"string"==typeof a.errorResultXdr)try{let e=s.xdr.ScVal.fromXDR(a.errorResultXdr,"base64");n+=". Error details: ".concat(JSON.stringify(s.scValToNative(e)))}catch(e){console.warn("Could not parse errorResultXdr",e)}throw console.error("Error in callContractFunction ('".concat(e,"'):"),{error:n,source:o,functionName:e,args:JSON.stringify(t.map(e=>s.scValToNative(e))),stack:a instanceof Error?a.stack:void 0}),Error("Failed to call '".concat(e,"': ").concat(n))}}function T(){let[e,t]=(0,a.useState)(null),[o,l]=(0,a.useState)(!1),[c,i]=(0,a.useState)(!1),[d,u]=(0,a.useState)(null),[m,g]=(0,a.useState)(!1),[h,w]=(0,a.useState)(!1),[x,f]=(0,a.useState)(!1),[y,p]=(0,a.useState)({status:"idle",message:""}),{publicKey:b,isConnected:v,connect:k,disconnect:j,error:N,isLoading:S}=(0,r.v)(),C=async()=>{try{w(!0),i(!1),t(null),u(null),z(e=>e.map(e=>({...e,voteCount:0}))),await j(),f(!1),p({status:"idle",message:""}),setTimeout(()=>{window.location.reload()},500)}catch(e){console.error("Error disconnecting wallet:",e),f(!0),p({status:"error",message:"\xc7ıkış yapılırken bir hata oluştu. L\xfctfen sayfayı yenileyin."})}finally{w(!1)}},[T,z]=(0,a.useState)([{id:0,name:"Proje A",description:"Yenilenebilir Enerji \xc7\xf6z\xfcmleri",voteCount:0},{id:1,name:"Proje B",description:"Eğitim Teknolojileri Platformu",voteCount:0},{id:2,name:"Proje C",description:"Sağlık Hizmetleri İnovasyonu",voteCount:0}]),R=async()=>{if(console.log("loadVoteCounts called, userAddress:",b),!b)return void console.log("No user address, skipping loadVoteCounts");try{console.log("Loading vote counts for candidates:",T.length);let e=[...T].map(async(e,t)=>{console.log("Loading vote count for candidate ".concat(t," (").concat(e.name,")"));try{let o=await E("get_vote_count",[P(t)],b,!0);if(console.log("Got vote count for candidate ".concat(t,":"),o),o){let n=B(o);return console.log("Converted vote count for candidate ".concat(t,":"),n),{...e,voteCount:Number(n)||0}}return e}catch(o){return console.error("Aday ".concat(t," (").concat(e.name,") i\xe7in oy y\xfcklenirken hata:"),o),{...e,voteCount:0}}}),t=await Promise.all(e);console.log("All vote counts loaded:",t),z(t)}catch(e){console.error("Oy sayıları y\xfcklenirken genel hata:",e),z(e=>{let t=e.map(e=>({...e,voteCount:0}));return console.log("Reset vote counts due to error:",t),t})}},D=async e=>{if(!e)return!1;try{let t=await E("has_voted",[L(e)],e,!0),o=!!B(t);return i(o),o}catch(e){return console.error("Oy durumu kontrol edilirken hata:",e),i(!1),!1}};(0,a.useEffect)(()=>{console.log("Wallet connection state changed:",{isConnected:v,userAddress:b}),(async()=>{if(v&&b){console.log("Wallet connected, loading data...");try{console.log("Loading vote counts and user vote status..."),await Promise.all([R(),D(b)]),console.log("Data loaded successfully")}catch(e){console.error("Veri y\xfcklenirken hata oluştu:",e),f(!0),p({status:"error",message:"Veriler y\xfcklenirken bir hata oluştu. L\xfctfen sayfayı yenileyin."})}}else v||S||console.log("Wallet not connected, showing connect button")})()},[v,b,S]);let F=async()=>{if(console.log("Checking wallet connection..."),v)console.log("Wallet already connected");else{console.log("Wallet not connected, attempting to connect..."),g(!0),u(null);try{await k(),console.log("Wallet connected successfully")}catch(t){console.error("Failed to connect wallet:",t);let e=t instanceof Error?t.message:"Bilinmeyen bir hata oluştu";throw u("C\xfczdana bağlanılamadı: ".concat(e)),t}finally{g(!1)}}},L=e=>{let t=s.StrKey.decodeEd25519PublicKey(e);return s.xdr.ScVal.scvAddress(s.xdr.ScAddress.scAddressTypeAccount(s.xdr.PublicKey.publicKeyTypeEd25519(t)))},P=e=>s.xdr.ScVal.scvU32(e),B=e=>{try{if(null==e)return e;return(0,s.scValToNative)(e)}catch(t){return console.error("Error converting ScVal:",t,e),e}},A=async()=>{if(null===e){f(!0),p({status:"error",message:"L\xfctfen bir aday se\xe7iniz"});return}try{if(!window.confirm('"'.concat(T[e].name,'" adayına oy vermek istediğinizden emin misiniz?')))return;if(!b){f(!0),p({status:"error",message:"Kullanıcı adresi bulunamadı. L\xfctfen c\xfczdan bağlantınızı kontrol edin."});return}l(!0),f(!0),p({status:"pending",message:"Oyunuz g\xf6nderiliyor, l\xfctfen bekleyin..."});try{await E("vote",[L(b),P(e)],b,!1,12e4),await R(),i(!0),p({status:"success",message:"Oyunuz başarıyla kaydedildi! Sayfa yenileniyor..."}),setTimeout(()=>{window.location.reload()},2e3)}catch(o){console.error("Voting error:",o);let e=o instanceof Error?o.message:"Beklenmeyen bir hata oluştu",t="Oy verme işlemi başarısız oldu";throw e.includes("timeout")?t="İşlem zaman aşımına uğradı. L\xfctfen bağlantınızı kontrol edip tekrar deneyin.":e.includes("insufficient")?t="Yetersiz bakiye. L\xfctfen c\xfczdanınızda yeterli XLM olduğundan emin olun.":e.includes("already voted")&&(t="Zaten oy kullanmışsınız. Her kullanıcı sadece bir kez oy kullanabilir."),f(!0),p({status:"error",message:t}),o}finally{l(!1)}}catch(e){console.error("Oylama hatası:",e),f(!0),p({status:"error",message:"Oylama sırasında bir hata oluştu: ".concat(e instanceof Error?e.message:String(e))})}},V=T.reduce((e,t)=>e+t.voteCount,0);return S?(0,n.jsxs)("div",{className:"bg-gray-800 p-6 rounded-lg shadow-lg text-white text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,n.jsx)("p",{children:"C\xfczdan bağlantısı kontrol ediliyor..."})]}):N||d?(0,n.jsx)("div",{className:"bg-gray-800 p-6 rounded-lg shadow-lg text-white",children:(0,n.jsx)("div",{className:"bg-red-900/50 border-l-4 border-red-500 p-4 mb-6",children:(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)("svg",{className:"h-5 w-5 text-red-300",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,n.jsxs)("div",{className:"ml-3",children:[(0,n.jsx)("p",{className:"text-sm text-red-300",children:N||d}),(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)("button",{onClick:F,disabled:m,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:m?"Bağlanılıyor...":"Tekrar Dene"})})]})]})})}):(0,n.jsxs)("div",{className:"relative",children:[(()=>{if(!x)return null;let e={pending:{bg:"bg-yellow-900/50",border:"border-yellow-500",icon:(0,n.jsxs)("svg",{className:"animate-spin h-5 w-5 text-yellow-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})},success:{bg:"bg-green-900/50",border:"border-green-500",icon:(0,n.jsx)("svg",{className:"h-5 w-5 text-green-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})},error:{bg:"bg-red-900/50",border:"border-red-500",icon:(0,n.jsx)("svg",{className:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}},t=e["idle"===y.status?"pending":y.status]||e.error;return(0,n.jsx)("div",{className:"fixed bottom-4 right-4 z-50 max-w-md w-full",children:(0,n.jsx)("div",{className:"".concat(t.bg," ").concat(t.border," border-l-4 p-4 rounded-lg shadow-lg"),children:(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("div",{className:"flex-shrink-0 pt-0.5",children:t.icon}),(0,n.jsxs)("div",{className:"ml-3 flex-1",children:[(0,n.jsx)("p",{className:"text-sm text-white",children:y.message}),y.txHash&&(0,n.jsx)("div",{className:"mt-1",children:(0,n.jsx)("a",{href:"https://testnet.steexp.com/tx/".concat(y.txHash),target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-300 hover:underline",children:"İşlemi G\xf6r\xfcnt\xfcle"})})]}),(0,n.jsx)("div",{className:"ml-4 flex-shrink-0 flex",children:(0,n.jsxs)("button",{onClick:()=>f(!1),className:"text-gray-300 hover:text-white",children:[(0,n.jsx)("span",{className:"sr-only",children:"Kapat"}),(0,n.jsx)("svg",{className:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})]})})})})(),(0,n.jsxs)("div",{className:"bg-gray-800 p-6 rounded-lg shadow-lg text-white",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold",children:"Projeleri Oyla"}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[v?(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsxs)("button",{onClick:C,className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded-md text-sm font-medium transition-colors flex items-center",children:[(0,n.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"\xc7ıkış Yap"]}),(0,n.jsx)("button",{onClick:()=>{b&&(R(),D(b))},disabled:h||o,className:"px-3 py-1 bg-gray-600 hover:bg-gray-700 text-white rounded-md text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{className:"animate-spin -ml-1 mr-1 h-3 w-3 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Y\xfckleniyor..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Yenile"]})})]}):(0,n.jsx)("button",{onClick:F,disabled:m||S,className:"px-4 py-2 rounded-md font-medium flex items-center justify-center min-w-32 ".concat(m||S?"bg-gray-500 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"," text-white transition-colors"),children:m||S?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Bağlanılıyor..."]}):"C\xfczdanı Bağla"}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"h-3 w-3 rounded-full mr-2 ".concat(v?"bg-green-500":"bg-yellow-500")}),(0,n.jsx)("span",{className:"text-sm",children:v?"Bağlandı":"Bağlantı Yok"})]})]})]}),(0,n.jsx)("div",{className:"space-y-4",children:T.map(o=>(0,n.jsxs)("div",{className:"p-4 border rounded-lg cursor-pointer transition-colors ".concat(e===o.id?"border-blue-500 bg-blue-900/20":"border-gray-700 hover:border-gray-600"),onClick:()=>t(o.id),children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-bold text-lg",children:o.name}),(0,n.jsx)("p",{className:"text-gray-300 text-sm",children:o.description})]}),(0,n.jsxs)("div",{className:"text-right",children:[(0,n.jsx)("div",{className:"text-2xl font-bold",children:o.voteCount}),(0,n.jsx)("div",{className:"text-xs text-gray-400",children:"oy"})]})]}),V>0&&(0,n.jsx)("div",{className:"mt-2 w-full bg-gray-700 rounded-full h-2.5",children:(0,n.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:"".concat(o.voteCount/Math.max(1,V)*100,"%"),transition:"width 0.5s ease-in-out"}})})]},o.id))}),(0,n.jsx)("div",{className:"mt-6",children:(0,n.jsx)("button",{onClick:A,disabled:null===e||o||c,className:"w-full py-3 px-4 rounded-lg font-bold transition-colors ".concat(null===e||c?"bg-gray-600 cursor-not-allowed":"bg-green-600 hover:bg-green-700"),children:o?"İşleniyor...":c?"Oyunuz Kaydedildi!":"Oy Ver"})}),(0,n.jsxs)("p",{className:"mt-4 text-sm text-gray-400 text-center",children:["Toplam oy: ",V]})]})]})}},6245:(e,t,o)=>{o.d(t,{r:()=>l,v:()=>c});var n=o(5155),a=o(2115),r=o(6338);let s=(0,a.createContext)(void 0),l=e=>{let{children:t}=e,[o,l]=(0,a.useState)(!1),[c,i]=(0,a.useState)(null),[d,u]=(0,a.useState)(null),[m,g]=(0,a.useState)(!0),[h,w]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{console.log("Initializing wallet connection..."),g(!0);try{let e=await r.isConnected().catch(()=>!1);if(console.log("Freighter available:",e),e){let e=await r.isConnected();if(console.log("Freighter connected:",e),e){console.log("Getting account info...");let e=await x();console.log("Account info loaded:",{isConnected:e.isConnected,publicKey:e.publicKey?"***"+e.publicKey.slice(-4):null,network:e.network})}else console.log("Freighter is not connected, user needs to connect manually"),l(!1),i(null),u(null)}else console.log("Freighter extension not detected"),w("Freighter uzantısı bulunamadı. L\xfctfen Freighter c\xfczdanını y\xfckleyin."),l(!1),i(null),u(null)}catch(e){console.error("Error initializing wallet:",e),w("C\xfczdan bağlantısı başlatılırken hata oluştu")}finally{console.log("Finished initializing wallet connection"),g(!1)}})();let e=()=>{console.log("Account changed, refreshing wallet info..."),x().catch(console.error)};return window.addEventListener("accountChanged",e),()=>{window.removeEventListener("accountChanged",e)}},[]);let x=async()=>{try{let e=await r.getAddress(),t="string"==typeof e?e:(null==e?void 0:e.address)||null,o=await r.getNetwork(),n="string"==typeof o?o:(null==o?void 0:o.network)||null,a=!!t;return i(t),u(n),l(a),w(a?null:"Ge\xe7eriz c\xfczdan adresi alındı"),{publicKey:t,network:n,isConnected:a}}catch(e){throw console.error("Error getting account info:",e),w("Hesap bilgileri alınamadı"),l(!1),i(null),u(null),e}},f=async()=>{console.log("Connecting wallet..."),g(!0),w(null);try{console.log("Requesting access to Freighter..."),await r.requestAccess(),console.log("Access granted, getting account info..."),await x(),console.log("Wallet connected successfully")}catch(t){console.error("Error connecting wallet:",t);let e=t instanceof Error?t.message:String(t);throw w("C\xfczdana bağlanılamadı: ".concat(e,". L\xfctfen tekrar deneyin.")),l(!1),i(null),u(null),t}finally{console.log("Finished wallet connection attempt"),g(!1)}},y=async()=>{try{console.log("Starting wallet disconnection..."),l(!1),i(null),u(null),w(null);try{for(let e of(localStorage.clear(),sessionStorage.clear(),document.cookie.split(";"))){let[t]=e.split("="),o=t.trim();document.cookie="".concat(o,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; domain=").concat(window.location.hostname,";"),document.cookie="".concat(o,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"),document.cookie="".concat(o,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/; domain=.").concat(window.location.hostname,";")}for(let e of(await window.indexedDB.databases()))if(e.name)try{window.indexedDB.deleteDatabase(e.name)}catch(t){console.warn("Could not delete database ".concat(e.name),t)}if("caches"in window)try{let e=await caches.keys();await Promise.all(e.map(e=>caches.delete(e)))}catch(e){console.warn("Failed to clear caches",e)}console.log("All storage cleared")}catch(e){console.error("Error clearing storage:",e)}window.dispatchEvent(new CustomEvent("walletDisconnected"));{let e=new Date().getTime();window.location.href="".concat(window.location.origin,"?reset=").concat(e)}}catch(e){console.error("Error during wallet disconnection:",e),window.location.href=window.location.origin}};return(0,n.jsx)(s.Provider,{value:{isConnected:o,publicKey:c,network:d,connect:f,disconnect:y,isLoading:m,error:h},children:t})},c=()=>{let e=(0,a.useContext)(s);if(void 0===e)throw Error("useWallet must be used within a WalletProvider");return e}}}]);